import{S as c,T as o}from"./index-5d1f5b00.js";import{c as h}from"./cartStore-ca6dfb2e.js";const{VITE_API_PATH:s,VITE_API_URL:a}={VITE_API_PATH:"truth",VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",BASE_URL:"/URCAR/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},l=c("payStore",{state:()=>({form:{},order:{},orderId:"",router:{},payError:!1}),actions:{sendOrder(e,r,t){o.post(`${a}api/${s}/order`,e).then(i=>{this.orderId=i.data.orderId,this.getOrder(r),t.resetForm();const{cartChcek:d}=h();d(),r.push("/pay")}).catch(()=>{alert('目前沒有預約的車款資訊，請您於"方案選擇"預約並確定資訊後再行填寫，謝謝。')})},getOrder(e,r){this.orderId===""&&(r==null?void 0:r.name)==="pay"?(alert("此為結帳頁面，請由預訂車輛步驟或查詢訂單後再進入此頁進行結帳，謝謝。"),setTimeout(function(){e.push("/productList")},1e3)):this.orderId!==""&&o.get(`${a}api/${s}/order/${this.orderId}`).then(t=>{this.order=t.data.order,this.order.total=this.order.total.toLocaleString("en-US",{style:"decimal",maximumFractionDigits:2})}).catch(t=>{console.log(t)})},focusNext(e,r){const t=r.querySelectorAll("input");t&&t[e-1].value.length===4&&t[e].focus()},cardNumberCheck(e){this.payError=!1;const r=e.cardNumber.find(t=>t.length<4);return(r==null?void 0:r.length)<4?(this.payError=!0,!1):e.securityCode<3?(this.payError=!0,!1):!0},pay(e,r){this.cardNumberCheck(e)&&o.post(`${a}api/${s}/pay/${this.order.id}`,this.order.id).then(()=>{r.push("/paySuccess")}).then(()=>{})}}});export{l as p};
